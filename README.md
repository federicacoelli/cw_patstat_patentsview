# Readme

This repository provides the code necessary to replicate the crosswalk from PatentsView to PATSTAT for the research paper *"Automation: The Decline of Capital-Labor Complementarity?"*, authored by Federica Coelli, David Dorn, David Hemous, and Morten Olsen.

## Project Structure

The project is organized into several tasks. Each task has its own folder in the main directory, and every task folder contains three subfolders:

- **input**: contains input data files for the task.
- **src**: contains the source code (scripts) for the task.
- **output**: stores the results and generated files from the task.

The output from one task serves as input for the next task. We use Unix's `make` utility to automate this process, ensuring the tasks are executed in the correct order.

## Steps to Replicate the Code

### Step 1: Set Up the Environment

1. Download or clone this repository to your local machine.
2. Install the following software on your system:
   - Stata 17
   - GNU Make 3.81 or later
   - A Unix-like terminal (Linux, macOS, or Windows with WSL).

3. Ensure symbolic links are enabled, as the workflow depends on them.

### Step 2: Configure Data Paths

1. Open the `path.txt` file located in the root directory of the repository.
2. Replace line 1 with the file path where you have stored the PATSTAT data on your local machine.
3. Replace line 2 with the file path where you have stored the PatentsView data on your local machine.

   This is necessary for the code to correctly locate the datasets.

### Step 3: Reproducing the Results Using `make`

1. Open a terminal and navigate to the folder where you saved the repository.
2. Run `make` by typing the following command:
   ```bash
   make
   ```

   This will execute the code for all tasks in sequence, using the Makefile to ensure proper task order and dependency management.

3. Mac OS X users: Ensure that you can run Stata scripts from the terminal by using the command `stata-se`. You may need to add `stata-se` to your systemâ€™s PATH variable.

### Step 4: Replicating Results Task by Task

If you prefer to execute the tasks individually, follow these steps:

1. Navigate to the task folder you wish to run.
2. In the terminal, navigate to the task folder and run the following command:
   ```bash
   make
   ```
   This will execute only the code for that specific task. The input files for each task will be automatically generated by the Makefile, provided all preceding tasks have been successfully executed.

Alternatively, you can manually run the Stata dofiles for each task. To do this:

1. Navigate to the `src` folder of the task you want to execute.
2. Place the necessary input files in the task's `input` subfolder. These input files are specified in the Makefile within each task's `src` folder.
3. Execute the Stata script (dofile) for that task.

### Notes:
- The Makefile in the root directory defines the order of the tasks. Ensure all preceding tasks have been successfully executed before running a specific task.
- If running the Stata dofiles manually, you will need to manually create the input and output folders for each task.

## Data Sources

1. PATSTAT: Fall 2018 version (this dataset must be purchased).
2. PatentsView: Data as of December 31, 2019 (available for download from [PatentsView](https://patentsview.org/download/data-download-tables)).